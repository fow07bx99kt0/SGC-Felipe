<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SGC ‚Äì Sistema de Gest√£o de Conhecimento</title>
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; frame-ancestors 'self' teams.microsoft.com *.teams.microsoft.com *.office.com *.microsoft.com; frame-src 'self' https: data: *.sharepoint.com *.office.com *.microsoft.com; connect-src 'self' https:; img-src 'self' https: data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline';" />
  <style>
    :root {
      --brand: #0ea5e9;
      --bg: #f8fafc;
      --text: #0f172a;
      --muted: #475569;
      --card: #ffffff;
      --radius: 18px;
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial; color: var(--text); background: linear-gradient(#f8fafc,#eef2f7); }
    .container { max-width: 1100px; margin: 24px auto; padding: 0 16px; }
    header { display:flex; align-items:center; justify-content: space-between; gap: 12px; margin-bottom: 16px; }
    header h1 { font-size: 22px; margin: 0; display:flex; align-items:center; gap: 10px; }
    .actions { display:flex; gap: 10px; }
    button { border: 1px solid #e2e8f0; padding: 10px 14px; border-radius: 14px; background: #fff; cursor: pointer; }
    button.primary { background: var(--brand); color: #fff; border-color: var(--brand); }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(240px,1fr)); gap: 16px; }
    .card { background: var(--card); border:1px solid #e2e8f0; border-radius: var(--radius); padding: 18px; box-shadow: 0 2px 8px rgba(0,0,0,.04); cursor:pointer; transition: transform .08s ease, box-shadow .12s ease; }
    .card:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(0,0,0,.08); }
    .card h3 { margin: 10px 0 6px 0; font-size: 16px; }
    .card p { margin: 0; color: var(--muted); font-size: 13px; }
    .iconbox { width: 46px; height: 46px; border-radius: 14px; background: #fff; border:1px solid #e2e8f0; display:grid; place-items:center; }
    .muted { color: var(--muted); }
    #viewer { width: 100%; height: 72vh; border: 1px solid #e2e8f0; background: #fff; border-radius: var(--radius); overflow:hidden; }
    iframe { width: 100%; height: 100%; border: 0; }
    .hidden { display:none; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><img src="assets/logo.svg" width="28" height="28" alt="SGC"/> SGC ‚Äì Sistema de Gest√£o de Conhecimento</h1>
      <div class="actions">
        <button id="btnBack">Voltar</button>
        <button class="primary" id="btnHome">P√°gina inicial</button>
      </div>
    </header>

    <p class="muted" id="subtitle">Escolha uma categoria para visualizar os documentos diretamente aqui no SGC.</p>

    <section id="home">
      <div class="grid" id="cards"></div>
    </section>

    <section id="list" class="hidden">
      <h2 id="listTitle" style="margin:0 0 8px 0; font-size:18px;"></h2>
      <div id="viewer"><iframe id="embed" title="Visualiza√ß√£o SGC"></iframe></div>
    </section>
  </div>

  <script>
    const TENANT_HOST = "corpalloteamentos.sharepoint.com";
    const FOLDERS = {"Engenharia": "https://corpalloteamentos.sharepoint.com/:f:/r/sites/Corpal/Processos/GEST%C3%83O%20DE%20CONHECIMENTO/02.%20DOCUMENTAL%20DE%20PROCESSOS/ENGENHARIA?csf=1&web=1&e=rEbGW5", "BackOffice": "https://corpalloteamentos.sharepoint.com/:f:/r/sites/Corpal/Processos/GEST%C3%83O%20DE%20CONHECIMENTO/02.%20DOCUMENTAL%20DE%20PROCESSOS/BACKOFFICE?csf=1&web=1&e=b3W0M4", "Neg√≥cios": "https://corpalloteamentos.sharepoint.com/:f:/r/sites/Corpal/Processos/GEST%C3%83O%20DE%20CONHECIMENTO/02.%20DOCUMENTAL%20DE%20PROCESSOS/NEG%C3%93CIOS?csf=1&web=1&e=K0tzaA", "Pol√≠ticas": "https://corpalloteamentos.sharepoint.com/:f:/r/sites/Corpal/Processos/GEST%C3%83O%20DE%20CONHECIMENTO/01.%20INSTITUCIONAL?csf=1&web=1&e=uQ0VeK", "Manuais": "https://corpalloteamentos.sharepoint.com/:f:/r/sites/Corpal/Processos/GEST%C3%83O%20DE%20CONHECIMENTO/03.%20MANUAIS?csf=1&web=1&e=au4hZX", "Modelos de Documentos": "https://corpalloteamentos.sharepoint.com/:f:/r/sites/Corpal/Processos/GEST%C3%83O%20DE%20CONHECIMENTO/04.%20MODELOS%20E%20LOGOS?csf=1&web=1&e=cCenYW", "Treinamentos": "https://corpalloteamentos.sharepoint.com/:f:/r/sites/Corpal/Processos/GEST%C3%83O%20DE%20CONHECIMENTO/05.%20TREINAMENTOS?csf=1&web=1&e=AatK1K"};

    const categories = [
      ["Engenharia","Projetos, padr√µes, checklists"],
      ["BackOffice","Compras, RH, administrativo"],
      ["Neg√≥cios","Comercial, propostas, playbooks"],
      ["Pol√≠ticas","Normas internas e compliance"],
      ["Manuais","Guias e procedimentos"],
      ["Modelos de Documentos","Templates padronizados"],
      ["Treinamentos","Conte√∫dos educacionais"]
    ];

    function buildEmbedUrl(webUrl) {
      if (!webUrl) return "";
      const encoded = encodeURIComponent(webUrl);
      return `https://${TENANT_HOST}/_layouts/15/Doc.aspx?src=${encoded}&action=embedview`;
    }

    // UI state
    const homeEl = document.getElementById('home');
    const listEl = document.getElementById('list');
    const cardsEl = document.getElementById('cards');
    const embedEl = document.getElementById('embed');
    const listTitle = document.getElementById('listTitle');
    const subtitle = document.getElementById('subtitle');

    // Buttons
    const btnHome = document.getElementById('btnHome');
    const btnBack = document.getElementById('btnBack');

    btnHome.onclick = () => showHome();
    btnBack.onclick = () => {
      if (!listEl.classList.contains('hidden')) showHome();
    };

    function showHome() {
      homeEl.classList.remove('hidden');
      listEl.classList.add('hidden');
      subtitle.textContent = "Escolha uma categoria para visualizar os documentos diretamente aqui no SGC.";
    }

    function showCategory(cat) {
      const url = FOLDERS[cat];
      homeEl.classList.add('hidden');
      listEl.classList.remove('hidden');
      listTitle.textContent = cat;
      subtitle.textContent = "Visualiza√ß√£o embutida da pasta do SharePoint.";
      embedEl.src = buildEmbedUrl(url);
    }

    // Build cards
    for (const [key, desc] of categories) {
      const card = document.createElement('div');
      card.className = 'card';
      card.onclick = () => showCategory(key);
      card.innerHTML = `
        <div class="iconbox">üìÅ</div>
        <h3>${key}</h3>
        <p>${desc}</p>
      `;
      cardsEl.appendChild(card);
    }

    showHome();
  </script>
</body>
</html>
